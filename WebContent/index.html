<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>会员管理入口页面</title>
		<link href="css/style.css" rel="stylesheet" />
		<link href="css/weui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/frozen.css">
		<script src="js/jquery-3.2.1.min.js"></script>
		<script src="js/weui.min.js"></script>
		<script src="js/zepto.min.js"></script>
	</head>

	<body>
	    <form id="memberindex" method="post">
		<header class="ui-header ui-header-positive ui-border-b">
			<h1>功能选项</h1>
		</header>
		<br />
		<br />

		<div class="page__bd">

			<div class="page">
				<div class="weui-grids">
					<a href="javascript:memberregister();" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/frame_64.png" alt="">
						</div>
						<p class="weui-grid__label">会员注册</p>
					</a>
					<a href="javascript:memberinfo();" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/flag_64.png" alt="">
						</div>
						<p class="weui-grid__label">我的资料</p>
					</a>
					<a href="javascript:mypromotion();" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/gear_64.png" alt="">
						</div>
						<p class="weui-grid__label">我的推广</p>
					</a>
					<a href="javascript:register();" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/book_64.png" alt="">
						</div>
						<p class="weui-grid__label">测试页面</p>
					</a>
					<a href="javascript:;" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/calendar_64.png" alt="">
						</div>
						<p class="weui-grid__label">预留</p>
					</a>
					<a href="javascript:;" class="weui-grid">
						<div class="weui-grid__icon">
							<img src="./images/book_bookmark_64.png" alt="">
						</div>
						<p class="weui-grid__label">预留</p>
					</a>
				</div>
			</div>

		</div>

		<div class="page__bd">
			<br />
			<br />
			<br />
			<article class="weui-article">
				<p>
					如果你不是微信进入此页面，请设定你的手机号码，作为测试数据为后续页面使用
				</p>

				<div class="weui-cell">
					<div class="weui-cell__hd"><label class="weui-label">手机号码</label></div>
					<div class="weui-cell__bd">
						<input id="membertelnumid" name="membertelnumname" class="weui-input" type="text" pattern="[0-9]*" placeholder="手机号码" />
					</div>
				</div>

				<div class="page__bd page__bd_spacing">
					<div class="page-btn-area">
						<a class="page-btn page-btn_primary" href="javascript:gettestfollowerid();">获取测试粉丝资料</a>
						<input type="hidden" id="followid" value="1" />
						<input type="hidden" id="membertel" value="2" />
					</div>
				</div>
			</article>
		</div>

		<div class="weui-footer">
			<br />
			<br />
			<p class="weui-footer__links">
				<a href="javascript:;" class="weui-footer__link">关于我们</a>
			</p>
			<p class="weui-footer__text">Copyright &copy; 2007-2017 XXXXX</p>
		</div>
		
		</form>
		
		
		<script type="text/javascript">
			function memberregister() {						
				var flid = document.getElementById('followid').value;
				var mbtel = document.getElementById('membertel').value;
				
				if(flid != "" & mbtel != ""){
					$.ajax({
						type: 'get',
						url: 'memberregister',
						cache: false,
						async: false,
						dataType: 'json',
						　　　　　　contentType: 'application/json',
						success: function(data) {
							window.location.href = 'memberregister.html?flid=' + flid + '&mbtel=' + mbtel;
						},
						error: function(data) {
							alert(data.msg);
						}
					});
				} else {
					alert("请先   获取测试粉丝资料");
				}
			}

			function memberinfo() {
				var flid = document.getElementById('followid').value;
				var mbtel = document.getElementById('membertel').value;
				
				if(flid != "" & mbtel != ""){

					$.ajax({
						type: 'get',
						url: 'memberinfo',
						cache: false,
						async: false,
						dataType: 'json',
						　　　　　　contentType: 'application/json',
						success: function(data) {
							window.location.href = 'memberinfo.html?flid=' + flid + '&mbtel=' + mbtel;
						},
						error: function(data) {
							alert(data.msg);
						}
					});
				} else {
					alert("请先   获取测试粉丝资料");
				}
			}

			function mypromotion() {
				var flid = document.getElementById('followid').value;
				var mbtel = document.getElementById('membertel').value;
				
				if(flid != "" & mbtel != ""){
					$.ajax({
						type: 'get',
						url: 'mypromotion',
						cache: false,
						async: false,
						dataType: 'json',
						　　　　　　contentType: 'application/json',
						success: function(data) {
							window.location.href = 'mypromotion.html?flid=' + flid;
						},
						error: function(data) {
							alert(data.msg);
						}
					});
				} else {
					alert("请先   获取测试粉丝资料");
				}
			}

			function register() {

				$.ajax({
					type: 'get',
					url: 'register',
					cache: false,
					async: false,
					dataType: 'json',
					　　　　　　contentType: 'application/json',
					success: function(data) {
						window.location.href = 'register';
					},
					error: function(data) {
						alert(data.msg);
					}
				});
			}
			
			//for test follower data
			$.fn.serializeObject = function() {
				var o = {};
				var a = this.serializeArray();
				$.each(a, function() {
					if(o[this.name]) {
						if(!o[this.name].push) {
							o[this.name] = [o[this.name]];
						}
						o[this.name].push(this.value || '');
					} else {
						o[this.name] = this.value || '';
					}
				});
				return o;
			};

			function gettestfollowerid() {

				var formdata = $('#memberindex').serializeObject();
				var mbtel = document.getElementById('membertelnumid').value;
				
				$("#followid").val('');
				$("#membertel").val('');
														
				if(mbtel != ""){
				
					$.ajax({
						type: 'post',
						url: 'gettestfollowerid',
						cache: false,
						dataType: 'json',
						data: JSON.stringify(formdata),
						contentType: 'application/json',
						　　　　　　async: false,
						success: function(data) {
							var result = JSON.stringify(data);
							//alert('success:' + data.id);
							
							$("#followid").val(data.id);
							$("#membertel").val(mbtel);
							
						},
						error: function(data) {
							alert('failed:' + data.msg);
						}
					});
					
				} else {
					alert("请输入  手机号码");
				}
			}
			
			
		</script>
	</body>

</html>